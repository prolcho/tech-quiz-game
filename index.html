<!DOCTYPE html>
<html lang="ko">
<head>
  <audio id="sfx-correct" src="correct.wav" preload="auto"></audio>
<audio id="sfx-wrong" src="wrong.wav" preload="auto"></audio>
<audio id="sfx-next" src="next.wav" preload="auto"></audio>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">

  <title>íƒ€ì ë“œë¡­ í€´ì¦ˆ++</title>

  <link href="https://fonts.googleapis.com/css2?family=Do+Hyeon&family=Orbitron:wght@500&display=swap" rel="stylesheet">


  <!-- Headì— ì¶”ê°€ -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pretendard@1.3.9/dist/web/static/pretendard.css" />

<button id="pauseBtn" onclick="togglePause()" style="
  position: absolute; top: 10px; left: 100px; z-index: 10;
  background: #111; color: #00ffe1; border: 1px solid #00ffe1;
  padding: 6px 12px; border-radius: 6px; font-size: 0.9rem;">
â¸ ì¼ì‹œì •ì§€
</button>

  


  <style>

:root {
  --main-accent: #b38bff; /* ê·€ì—¬ìš´ ë³´ë¼ë¹› ê°•ì¡°ìƒ‰ */
  --bg-dark: #0a0a0a;
  --bg-light: #1a1a1a;
  --text-bright: #fff;
}





    html, body {
      margin: 0; padding: 0; background: linear-gradient(180deg, #0a0a0a, #1a1a1a); overflow: hidden;
      /* ê¸°ì¡´ Gowun Dodum êµì²´ */
body {
  font-family: 'Pretendard', 'Orbitron', sans-serif;
}

    }
    canvas { display: block; }

    #questionBox {
    display: none;
      position: absolute; top: 30px; width: 100%; text-align: center;
      color: #00ffe1; font-size: 2rem; z-index: 10; text-shadow: 0 0 5px #0ff;
    }

    #scoreBox {
      position: absolute; top: 10px; left: 20px;
      color: #ffffff; font-size: 1rem; z-index: 10;
    }

    #inputBox {
      position: absolute; bottom: 60px; left: 50%; transform: translateX(-50%);
      z-index: 10;
    }

    #textInput {
  font-size: 1.5rem;
  padding: 0.5rem;
  width: 320px;
  border: 2px solid #00ffe1;
  border-radius: 8px;
  background: #000000;
  color: #00ffe1;
  text-align: center;
  transition: transform 0.1s ease, box-shadow 0.3s ease;
  caret-color: #ff0; /* âœ… ì¶”ê°€ */
}

#textInput::placeholder {
  color: #00ffe188;    /* âœ… ì‹ ê·œ ë¸”ë¡ ì „ì²´ ì¶”ê°€ */
  font-style: italic;
}


#textInput:focus {
  outline: none;
  box-shadow: 0 0 12px #00ffe1, 0 0 30px #00ffe155; /* ê¸°ì¡´ë³´ë‹¤ ë” ê°•í•˜ê²Œ */
  background-color: #111; /* ì‚´ì§ ë°ê²Œ */
}

    #textInput.shake {
      transform: translateX(-50%) scale(1.05) rotate(1deg);
      animation: shake 0.3s ease;
    }

    @keyframes shake {
      0% { transform: translateX(-50%) translateX(0px); }
      25% { transform: translateX(-50%) translateX(-5px); }
      50% { transform: translateX(-50%) translateX(5px); }
      75% { transform: translateX(-50%) translateX(-5px); }
      100% { transform: translateX(-50%) translateX(0px); }
    }

    #explainBox {
  position: absolute;
  bottom: 20px;
  width: 100%;
  text-align: center;
  color: #ff0;
  font-size: 1.2rem;
  display: none;
  background-color: rgba(255,255,255,0.05);
  padding: 10px;
  border-radius: 10px;
  border: 1px solid #888;  
  opacity: 0;
  transition: opacity 0.5s ease;
}
#explainBox.visible {
  opacity: 1;
}

#progressBox {
  position: absolute;
  top: 70px;
  width: 100%;
  display: flex;
  justify-content: center;
  gap: 10px;
  z-index: 10;
}
.progress-dot {
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background-color: #333;
  border: 2px solid #00ffe1;
  transition: background-color 0.3s ease;
}
.progress-dot.active {
  background-color: #00ffe1;
}




#floatingTextContainer {
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
  z-index: 999;
}
.floating-text {
  position: absolute;
  color: #ff0;
  font-size: 1.5rem;
  animation: floatUp 1s ease-out forwards;
}
@keyframes floatUp {
  0% { opacity: 1; transform: translateY(0); }
  100% { opacity: 0; transform: translateY(-50px); }
}

.fade-out {
  opacity: 0;
  transition: opacity 0.5s ease;
}

.fade-in {
  opacity: 1;
  transition: opacity 0.5s ease;
}

@keyframes zoomFadeIn {
  0% {
    transform: scale(0.95);
    opacity: 0;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

@keyframes zoomFadeOut {
  0% {
    transform: scale(1);
    opacity: 1;
  }
  100% {
    transform: scale(1.05);
    opacity: 0;
  }
}

.fade-in {
  animation: zoomFadeIn 0.5s ease forwards;
}

.fade-out {
  animation: zoomFadeOut 0.5s ease forwards;
}

body::before {
  content: "";
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background-image: radial-gradient(#00ffe1 0.5px, transparent 0.5px);
  background-size: 20px 20px;
  opacity: 0.03;
  z-index: 0;
  animation: gridMove 30s linear infinite;
}
@keyframes gridMove {
  from { background-position: 0 0; }
  to { background-position: 100px 100px; }
}



@media (max-width: 480px) {
  #textInput {
    width: 90vw;
    font-size: 1.2rem;
  }

  #questionBox {
    font-size: 1.4rem;
    top: 20px;
  }

  #explainBox {
    font-size: 1rem;
    padding: 8px;
  }

  #scoreBox, #failCountBox, #statusBox {
    font-size: 0.9rem;
  }

  #modeSelector {
    flex-direction: column;
    gap: 6px;
    font-size: 0.9rem;
    padding: 8px;
    left: 10px;
    top: 100px;
  }

  #manualHintButton,
  #restartCurrentBtn {
    left: 10px;
    bottom: auto;
    top: auto;
    transform: scale(0.9);
  }

  #restartCurrentBtn {
    left: auto;
    right: 10px;
  }

  #startScreen,
  #congratsScreen {
    font-size: 1.4rem;
    padding: 20px;
  }

  #fullHintPopup > div {
    padding: 10px;
  }

  #fullHintPopup h2 {
    font-size: 1.2rem;
  }

  #fullHintPopup #fullHintContent {
    font-size: 0.9rem;
  }
}





@media (max-width: 480px) {
  #textInput {
    width: 90vw;
    font-size: 1.2rem;
  }

  #questionBox {
    font-size: 1.4rem;
    top: 20px;
  }

  #explainBox {
    font-size: 1rem;
    padding: 8px;
  }

  #scoreBox, #failCountBox, #statusBox {
    font-size: 0.85rem;
  }

  #modeSelector {
    flex-direction: column;
    font-size: 0.9rem;
    left: 10px;
    top: 100px;
  }

  #manualHintButton,
  #restartCurrentBtn {
    bottom: 10px;
    transform: scale(0.9);
  }

  #restartCurrentBtn {
    right: 10px;
    left: auto;
  }

  #startScreen,
  #congratsScreen {
    font-size: 1.5rem;
    padding: 20px;
  }
}


    /* UI ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì¶”ê°€ ì˜ˆì • ì‹œ */
  </style>
</head>
<body>


<!-- âœ… ì „ì²´ íŒíŠ¸ ë³´ê¸° ìˆ˜ë™ ë²„íŠ¼ -->
<div id="manualHintButton" style="
  position: fixed;
  bottom: 20px;
  left: 20px;
  z-index: 1000;
">
  <button onclick="openFullHintManually()" style="
background: rgba(255, 255, 255, 0.06);
  border: 1px solid var(--main-accent);
  border-radius: 12px;
  color: var(--main-accent);
  font-family: 'Orbitron', sans-serif;
  font-size: 0.95rem;
  padding: 6px 12px;
  transition: all 0.3s ease;
  backdrop-filter: blur(4px);
  cursor: pointer;
  ">ğŸ’¡ íŒíŠ¸ ì „ì²´ ì—´ê¸°</button>
</div>



<div id="restartCurrentBtn" style="
  position: fixed;
  bottom: 20px;
  left: 160px;
  z-index: 1000;
">
  <button onclick="restartCurrentQuestion()" style="
background: rgba(255, 255, 255, 0.06);
  border: 1px solid var(--main-accent);
  border-radius: 12px;
  color: var(--main-accent);
  font-family: 'Orbitron', sans-serif;
  font-size: 0.95rem;
  padding: 6px 12px;
  transition: all 0.3s ease;
  backdrop-filter: blur(4px);
  cursor: pointer;
  ">ğŸ”„ í˜„ì¬ ë¬¸ì œ ë‹¤ì‹œ</button>
</div>







<div id="statusBox" style="
  position: fixed;
  top: 10px;
  right: 20px;
  background: rgba(0,0,0,0.7);
  color: #00ffff;
  padding: 8px 16px;
  border-radius: 12px;
  font-family: 'Orbitron', sans-serif;
  font-size: 14px;
  z-index: 999;
">
  ì§„í–‰: 1 / ?
</div>





<div id="modeSelector" style="
  position: fixed;
  top: 10px;
  left: 200px; /* â† ì—¬ê¸°ë§Œ ë³€ê²½ */
  z-index: 999;
  background: rgba(0,0,0,0.6);
  border-radius: 10px;
  padding: 6px 12px;
  display: flex;
  gap: 10px;
  font-size: 12px;
  font-family: 'Orbitron', sans-serif;
  color: #00ffe1;
">
  <label><input type="radio" name="mode" value="strict"> Strict</label>
  <label><input type="radio" name="mode" value="normal" checked> Normal</label>
  <label><input type="radio" name="mode" value="fuzzy"> Fuzzy</label>
</div>


<div id="skipHint" style="
  position: fixed;
  top: 60px;
  right: 20px;
  font-size: 0.8rem;
  color: #999;
  background: rgba(0, 0, 0, 0.6);
  padding: 4px 10px;
  border-radius: 8px;
  z-index: 999;
  font-family: 'Orbitron', sans-serif;
">
  â© Shift + â†’ í‚¤ë¡œ ë¬¸ì œ ìŠ¤í‚µ
</div>




  <div id="questionBox"></div>
  <div id="progressBox"></div>
<div id="pauseNotice" style="display:none; position:absolute; top:50%; left:50%;
transform:translate(-50%,-50%); color:#fff; font-size:2rem; background:#111; 
padding:1rem 2rem; border:2px solid #00ffe1; z-index:20;">
â¸ ì¼ì‹œì •ì§€ ì¤‘
</div>

  <div id="scoreBox">ì ìˆ˜: 0</div>
<div id="failCountBox" style="
  position: absolute;
  top: 80px;
  right: 20px;
  color: #ff8888;
  font-family: 'Orbitron', sans-serif;
  font-size: 16px;
  background: rgba(0, 0, 0, 0.5);
  padding: 6px 10px;
  border-radius: 6px;
  z-index: 100;
">
  âŒ Fail: 0
</div>




  <div id="inputBox">
    <input type="text" id="textInput" placeholder="ì—¬ê¸°ì— í‚¤ì›Œë“œ ì…ë ¥ í›„ Enter" autocomplete="off" />
  </div>
  <div id="explainBox"><span id="hintCharacter">âš¡ì „ê¸°ì‹ :</span> <span id="hintText"></span></div>

  <div id="floatingTextContainer"></div>

  <canvas id="canvas"></canvas>



<div id="congratsScreen" style="
  display: none;
  position: fixed;
  top: 0; left: 0;
  width: 100vw; height: 100vh;
  background: rgba(0, 0, 0, 0.95);
  color: #00ffcc;
  font-size: 2rem;
  font-family: 'Orbitron', sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  z-index: 9999;
  text-align: center;
">
  ğŸ‰ ëª¨ë“  ë¬¸ì œë¥¼ ì™„ë£Œí•˜ì…¨ìŠµë‹ˆë‹¤!<br><br>
  <button onclick="restartQuiz()" style="
background: rgba(255, 255, 255, 0.06);
  border: 1px solid var(--main-accent);
  border-radius: 12px;
  color: var(--main-accent);
  font-family: 'Orbitron', sans-serif;
  font-size: 0.95rem;
  padding: 6px 12px;
  transition: all 0.3s ease;
  backdrop-filter: blur(4px);
  cursor: pointer;
  ">ë‹¤ì‹œ ì‹œì‘í•˜ê¸°</button>
</div>


<div id="startScreen" style="
  position: fixed;
  top: 0; left: 0;
  width: 100vw; height: 100vh;
  background: rgba(0, 0, 0, 0.95);
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  color: #00ffe1;
  font-family: 'Orbitron', sans-serif;
  font-size: 1.8rem;
  z-index: 9999;
  text-align: center;
">
  ğŸ§  <strong>íƒ€ì ë“œë¡­ í€´ì¦ˆ++</strong><br><br>
  <span style="font-size: 1rem; color: #999">Enter í‚¤ ì…ë ¥ í˜¹ì€ í„°ì¹˜í•˜ì—¬ ì‹œì‘í•˜ì„¸ìš”</span>
</div>




  <script>









function restartCurrentQuestion() {
  // í˜„ì¬ ë¬¸ì œì˜ ìƒíƒœë¥¼ ì´ˆê¸°í™”
  failCount = 0;
  activeLetters = [];
  fallingLetters = [];
  particles = [];
  letterSpawnTimer = 0;
  isPaused = false;
  textInput.value = '';
  explainBox.style.display = 'none';
  explainBox.classList.remove('visible');
  document.getElementById('fullHintPopup').style.display = 'none';

  // ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê¸°
  loadQuestion();
  updateStatusBox();
  playSound("sfx-next"); // íš¨ê³¼ìŒìœ¼ë¡œ êµ¬ë¶„
}








function closeFullHintPopup() {
  document.getElementById('fullHintPopup').style.display = 'none';
  failCount = 0; // ğŸ” ì´ˆê¸°í™”
  updateFailCountUI(); // UIì—ë„ ë°˜ì˜
  explainBox.style.display = 'none'; // í•´ì„¤ì°½ë„ í•¨ê»˜ ìˆ¨ê¸°ê¸°
  explainBox.classList.remove('visible');
}







function openFullHintManually() {
  const fullHintBox = document.getElementById('fullHintPopup');
  const content = document.getElementById('fullHintContent');
  const currentQuiz = quizData[current];
  let html = `<strong>ë¬¸ì œ:</strong> ${currentQuiz.title}<br><br>`;
  html += `<strong>íŒíŠ¸:</strong> ${currentQuiz.hint}<br><br>`;
  html += `<strong>ì •ë‹µ ëª©ë¡:</strong><br><ul>`;
  currentQuiz.answers.forEach(ans => {
    html += `<li><strong>${ans.letter}</strong>: ${ans.text}</li>`;
  });
  html += `</ul><br><em style="color:#ccc;">â€» í•™ìŠµìš©ìœ¼ë¡œ ì •ë‹µ ì „ì²´ë¥¼ ë³´ì—¬ë“œë¦½ë‹ˆë‹¤.</em>`;
  content.innerHTML = html;
  fullHintBox.style.display = 'block';
}





function restartQuiz() {
  current = 0;
  score = 0;
  failCount = 0;
  document.getElementById('congratsScreen').style.display = 'none';
  shuffleArray(quizData); // ë‹¤ì‹œ ì„ê³ 
  loadQuestion();
  updateProgressUI();
  updateStatusBox();
}




function updateStatusBox() {
  const statusBox = document.getElementById('statusBox');
  statusBox.textContent = `ì§„í–‰: ${current + 1} / ${quizData.length}`;
}




function togglePause() {
  isPaused = !isPaused;
  wasManuallyPaused = isPaused; // âœ… ì¼ì‹œì •ì§€ í–ˆëŠ”ì§€ ê¸°ì–µí•´ë‘ 

  const pauseBox = document.getElementById('pauseNotice');
  const pauseBtn = document.getElementById('pauseBtn');

  pauseBox.style.display = isPaused ? 'block' : 'none';
  pauseBtn.textContent = isPaused ? "â–¶ ì¬ê°œ" : "â¸ ì¼ì‹œì •ì§€";

  if (!isPaused) animate();
}



function updateProgressUI() {
  const box = document.getElementById('progressBox');
  box.innerHTML = ''; // ì´ˆê¸°í™”
  const total = quizData[current].answers.length;
  const currentHits = total - activeLetters.length;
  for (let i = 0; i < total; i++) {
    const dot = document.createElement('div');
    dot.classList.add('progress-dot');
    if (i < currentHits) dot.classList.add('active');
    box.appendChild(dot);
  }
}


function showFloatingText(x, y, text = "+1ì !") {
  const span = document.createElement("span");
  span.className = "floating-text";
  span.textContent = text;
  span.style.left = `${x}px`;
  span.style.top = `${y}px`;
  document.getElementById("floatingTextContainer").appendChild(span);
  setTimeout(() => span.remove(), 1000);
}
function playSound(id) {
  const sound = document.getElementById(id);
  if (sound) {
    sound.currentTime = 0;
    sound.play();
  }
}


    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
window.addEventListener('resize', () => {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});




    canvas.height = window.innerHeight;

    const questionBox = document.getElementById('questionBox');
    const scoreBox = document.getElementById('scoreBox');
    const textInput = document.getElementById('textInput');
    const explainBox = document.getElementById('explainBox');

    const quizData = [
{
  title: "1. 3ìƒì—ì„œ ë‹¨ìƒìœ¼ë¡œ ë³€í™˜ ê²°ì„ ",
  hint: "ìŠ¤ë³€ì—­ë¦¬",
  answers: [
    {
      letter: "ìŠ¤",
      text: "ìŠ¤ì½”íŠ¸ê²°ì„ ",
      aliases: ["ìŠ¤ì½”íŠ¸", "ìŠ¤ì½”íŠ¸ ê²°ì„ ", "Scott ê²°ì„ ", "Scott connection"]
    },
    {
      letter: "ë³€",
      text: "ë³€í˜•ìš°ë“œë¸Œë¦¬ì§€ê²°ì„ ",
      aliases: ["ë³€í˜•ìš°ë“œë¸Œë¦¬ì§€", "ìš°ë“œë¸Œë¦¬ì§€", "ìš°ë“œë¸Œë¦¬ì§€ ê²°ì„ ", "Woodbridge ê²°ì„ "]
    },
    {
      letter: "ì—­",
      text: "ì—­Vê²°ì„ ",
      aliases: ["ì—­V", "ì—­V ê²°ì„ ", "ì—­ë¸Œì´ê²°ì„ ", "ì—­ ë¸Œì´ ê²°ì„ "]
    },
    {
      letter: "ë¦¬",
      text: "ë¦¬ì•¡í„°ì™€ ì½˜ë´ì„œì— ì˜í•œ ë°©ë²•",
      aliases: ["ë¦¬ì•¡í„°", "ì½˜ë´ì„œ", "ë¦¬ì•¡í„° ì½˜ë´ì„œ ë°©ë²•", "ë¦¬ì•¡í„°ì™€ ì½˜ë´ì„œ", "ë¦¬ì•¡í„° ì½˜ë´ì„œ"]
    }
  ],
  explain: "3ìƒì„ ë‹¨ìƒìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ëŒ€í‘œì  ë°©ì‹ì€ ìŠ¤ì½”íŠ¸ê²°ì„ , ë³€í˜•ìš°ë“œë¸Œë¦¬ì§€ê²°ì„ , ì—­Vê²°ì„ , ê·¸ë¦¬ê³  ë¦¬ì•¡í„°ì™€ ì½˜ë´ì„œì— ì˜í•œ ë°©ë²•ì´ ìˆë‹¤."
},


 {
  title: "1-1. ìŠ¤ì½”íŠ¸ê²°ì„ ì˜ íŠ¹ì§•",
  hint: "ë‹¨ìŠ¤ì „êµì´ì¤‘ê¶Œí†µ",
  answers: [
    {
      letter: "ë‹¨",
      text: "ë‹¨ìƒë³€ì••ê¸° 2ê°œë¥¼ Tí˜•ìœ¼ë¡œ ê²°ì„ í•œ ë°©ì‹",
      aliases: ["ë‹¨ìƒë³€ì••ê¸°", "Tí˜•ê²°ì„ ", "Tí˜•", "Tí˜• ê²°ì„ "]
    },
    {
      letter: "ìŠ¤",
      text: "ìŠ¤ì½”íŠ¸ê²°ì„  ì´ìš©ì‹œ 90ë„ ìœ„ìƒì°¨ê°€ ìˆëŠ” ë‹¨ìƒì „ì› 2ê°œë¥¼ ì–»ìŒ",
      aliases: ["90ë„ ìœ„ìƒì°¨", "ìœ„ìƒì°¨ 90ë„", "ë‹¨ìƒì „ì› 2ê°œ"]
    },
    {
      letter: "ì „",
      text: "ì „ì••ë¶ˆí‰í˜• ë°©ì§€ë¥¼ ìœ„í•´ ì‚¬ìš©",
      aliases: ["ì „ì••ë¶ˆí‰í˜•", "ì „ì••ë¶ˆê· í˜•", "ë¶ˆí‰í˜• ë°©ì§€"]
    },
    {
      letter: "êµ",
      text: "êµë¥˜ì „ê¸°ì² ë„ ATê¸‰ì „ë°©ì‹ì— ì£¼ë¡œ ì‚¬ìš©",
      aliases: ["ATê¸‰ì „ë°©ì‹", "êµë¥˜ì „ê¸°ì² ë„", "ê¸‰ì „ë°©ì‹"]
    },
    {
      letter: "ì´",
      text: "ì´ìš©ë¥ ì´ 92.8%ë¡œ ë†’ì€ í¸",
      aliases: ["ì´ìš©ë¥  92.8%", "ì´ìš©ë¥  ë†’ìŒ", "íš¨ìœ¨ 92.8%"]
    },
    {
      letter: "ì¤‘",
      text: "ì¤‘ì„±ì  ì ‘ì§€ ë¶ˆê°€",
      aliases: ["ì¤‘ì„±ì  ì—†ìŒ", "ì¤‘ì„±ì  ì ‘ì§€ ë¶ˆê°€", "ì ‘ì§€ ë¶ˆê°€"]
    },
    {
      letter: "ê¶Œ",
      text: "ê¶Œì„  ì„í”¼ë˜ìŠ¤ ì •í•© ë¶ˆê°€",
      aliases: ["ì„í”¼ë˜ìŠ¤ ì •í•© ì•ˆë¨", "ê¶Œì„  ì •í•© ë¶ˆê°€", "ì„í”¼ë˜ìŠ¤ ë¶ˆì¼ì¹˜"]
    },
    {
      letter: "í†µ",
      text: "í†µì‹ ì„  ìœ ë„ì¥ì•  ë°œìƒ",
      aliases: ["í†µì‹ ì„  ì¥ì• ", "ìœ ë„ì¥ì• ", "ìœ ë„ ì „ì••"]
    }
  ],
  explain: "ë‹¨ìƒ 2ê°œ Tí˜•, 90ë„ ìœ„ìƒì°¨, ì „ì••ë¶ˆí‰í˜• ë°©ì§€, ATê¸‰ì „ë°©ì‹ ì‚¬ìš©, ì´ìš©ë¥  92.8%, ì¤‘ì„±ì  ì ‘ì§€ ë¶ˆê°€, ì„í”¼ë˜ìŠ¤ ì •í•© ë¶ˆê°€, ìœ ë„ì¥ì•  ë°œìƒ"
},{
  title: "1-2. ë³€í˜•ìš°ë“œë¸Œë¦¬ì§€ê²°ì„ ì˜ íŠ¹ì§•",
  hint: "ìŠ¹ìŠ¤ìŠ¤ì „",
  answers: [
    {
      letter: "ìŠ¹",
      text: "ìŠ¹ì••ìš© ë‹¨ê¶Œë³€ì••ê¸°ë¥¼ ì´ìš©í•œ ë°©ì‹ì´ë‹¤",
      aliases: ["ìŠ¹ì••ìš© ë‹¨ê¶Œë³€ì••ê¸°", "ë‹¨ê¶Œë³€ì••ê¸°", "ìŠ¹ì••ìš©"]
    },
    {
      letter: "ìŠ¤",
      text: "ìŠ¤ì½”íŠ¸ê²°ì„  ë³€ì••ê¸°ì™€ ë™ì¼í•œ ê¸°ëŠ¥ì„ ê°€ì§€ë©´ì„œ 1ì°¨ì¸¡ì— ì¤‘ì„±ì  ì ‘ì§€ë¥¼ ì·¨í•˜ëŠ” ë°©ì‹",
      aliases: ["ìŠ¤ì½”íŠ¸ì™€ ë™ì¼ ê¸°ëŠ¥", "1ì°¨ì¸¡ ì¤‘ì„±ì  ì ‘ì§€", "ì¤‘ì„±ì  ì ‘ì§€"]
    },
    {
      letter: "ìŠ¤",
      text: "ìŠ¤ì½”íŠ¸ê²°ì„ ì˜ ê²°ì ì„ ë³´ì™„í•œ ë°©ì‹",
      aliases: ["ìŠ¤ì½”íŠ¸ê²°ì„  ë³´ì™„", "ê²°ì  ë³´ì™„", "ë³´ì™„ ë°©ì‹"]
    },
    {
      letter: "ì „",
      text: "ì „ê¸°ì² ë„ ì¥ì•  ë°©ì§€ìš©ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤(ì¼ë³¸)",
      aliases: ["ì „ê¸°ì² ë„", "ì¥ì•  ë°©ì§€", "ì¼ë³¸ ì „ì² "]
    }
  ],
  explain: "ë³€í˜•ìš°ë“œë¸Œë¦¬ì§€ê²°ì„ ì€ ìŠ¹ì••ìš© ë‹¨ê¶Œë³€ì••ê¸°ë¥¼ ì‚¬ìš©í•˜ê³ , ìŠ¤ì½”íŠ¸ê²°ì„ ì˜ ê¸°ëŠ¥ê³¼ ê²°ì ì„ ë³´ì™„í•˜ë©°, ì¤‘ì„±ì  ì ‘ì§€ê°€ ê°€ëŠ¥í•˜ê³  ì¼ë³¸ ì „ê¸°ì² ë„ì—ì„œ ì¥ì•  ë°©ì§€ìš©ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤."
}










];


let isStarted = false;
let current = 0;
let activeLetters = [];
let fallingLetters = [];


  let score = 0;
  let letterSpawnTimer = 0;
  let lives = 3;
  let isPaused = false;
  let particles = [];
  let failCount = 0;

// âœ… ì‹¤íŒ¨ íšŸìˆ˜ í‘œì‹œ í•¨ìˆ˜ (ì „ì—­ìœ¼ë¡œ ì´ë™)
function updateFailCountUI() {
  document.getElementById('failCountBox').textContent = `âŒ Fail: ${failCount}`;
}



let matchMode = 'normal'; // ê¸°ë³¸ ëª¨ë“œ

let wasManuallyPaused = false;


let animationFrameId = null;  // ğŸ”¥ ì• ë‹ˆë©”ì´ì…˜ ID ì¶”ì ìš©




    
const LETTER_SPEED = 1.0; // âœ… ì¼ì •í•œ ì†ë„

class FallingLetter {
  constructor(id, letter, answer, x) {
    this.id = id;           // ì¶”ê°€ë¨
    this.letter = letter;
    this.answer = answer;
    this.x = x;
    this.y = -50;
    this.speed = LETTER_SPEED;
    this.marked = false;
  }

      update() { this.y += this.speed; }
      draw(ctx) {
  ctx.font = '36px Orbitron';
  ctx.fillStyle = '#00ffe1';
  ctx.shadowColor = '#00ffff';
  ctx.shadowBlur = 15;
  ctx.fillText(this.letter, this.x, this.y);
  ctx.shadowBlur = 0; // reset
}

    }

    class Particle {
      constructor(x, y) {
        this.x = x;
        this.y = y;
        this.dx = (Math.random() - 0.5) * 6;
        this.dy = (Math.random() - 0.5) * 6;
        this.life = 60;
        this.size = 5 + Math.random() * 5;
      }
      update() {
        this.x += this.dx;
        this.y += this.dy;
        this.life--;
      }
      draw(ctx) {
        ctx.fillStyle = 'rgba(255, 255, 100, 0.8)';
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
      }
    }

function spawnLetter(letterObj) {
  const x = Math.random() * (canvas.width - 200) + 100;
  fallingLetters.push(new FallingLetter(letterObj.id, letterObj.letter, letterObj.answer, x));
}


    function explode(x, y) {
      for (let i = 0; i < 30; i++) {
        particles.push(new Particle(x, y));
      }
    }

    function animate() {
      if (isPaused) return;
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      letterSpawnTimer++;

      if (letterSpawnTimer % 180 === 0) {
        const remaining = activeLetters.filter(a =>
  !fallingLetters.find(l => l.id === a.id)
);

        if (remaining.length > 0) {
          const next = remaining[0];
spawnLetter(next);

        }
      }

      for (let i = fallingLetters.length - 1; i >= 0; i--) {
        const l = fallingLetters[i];
        l.update();
        l.draw(ctx);
        if (l.y > canvas.height + 30 && !l.marked) {
          fallingLetters.splice(i, 1);
          score -= 1;
          scoreBox.textContent = `ì ìˆ˜: ${score}`;
        }
      }

      for (let i = particles.length - 1; i >= 0; i--) {
        const p = particles[i];
        p.update();
        p.draw(ctx);
        if (p.life <= 0) particles.splice(i, 1);
      }



 animationFrameId = requestAnimationFrame(animate); // âœ… ì¤‘ë³µ ë°©ì§€



    }

function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}



function loadQuestion() {
  const q = quizData[current];
  textInput.value = '';
  explainBox.style.display = 'none';
  document.getElementById('fullHintPopup').style.display = 'none'; // âœ… íŒì—… ì´ˆê¸°í™”

  questionBox.textContent = q.title;
  questionBox.style.display = 'block';

  activeLetters = [...q.hint].map((char, i) => ({
    id: i,
    letter: char,
    answer: q.answers[i]
  }));

  letterSpawnTimer = 0;
  isPaused = false;
  failCount = 0;
  updateFailCountUI(); // âœ… ì‹¤íŒ¨ íšŸìˆ˜ UI ì´ˆê¸°í™”
  updateProgressUI();  // âœ… ì§„í–‰ë¥ ë„ ì—…ë°ì´íŠ¸

  if (!quizData || quizData.length === 0) return; // âœ… ì´ ë¶€ë¶„ë„ ì•ˆì— ìˆì–´ì•¼ í•¨
}





textInput.addEventListener('keydown', e => {
  if (e.key === 'Enter') {

if (e.key === 'Enter') {
  const isInputFocused = (document.activeElement.id === 'textInput');
  const isStartScreen = document.getElementById('startScreen').style.display !== 'none';
  const isCongratsScreen = document.getElementById('congratsScreen').style.display === 'flex';

  if (isStartScreen) {
    startQuiz(); // ì´ í•¨ìˆ˜ëŠ” ì•„ë˜ì—ì„œ ì¶”ê°€í•¨
    return;
  }

  if (isCongratsScreen) return;

  if (!isInputFocused) {
    e.preventDefault();
    textInput.focus();
    textInput.select();
  }
}


     if (isStarted && activeLetters.length === 0 && fallingLetters.length === 0) {
      if (current + 1 >= quizData.length) {
        document.getElementById('congratsScreen').style.display = 'flex';
        return;
      }
      // ë‹¤ìŒ ë¬¸ì œë¡œ ì´ë™
      current++;
      loadQuestion();
      updateStatusBox();
      textInput.value = '';
    }if (document.getElementById('congratsScreen').style.display === 'flex' && e.key === 'Enter') {
    restartQuiz();
    document.getElementById('startScreen').style.display = 'none';
      return;
    }





    // ğŸ”¹ ì´ë¯¸ ì‹œì‘ëœ ê²½ìš°: ì •ë‹µ ì²´í¬ ë¡œì§
    const input = textInput.value.trim();
    let matched = false;
    for (let i = 0; i < fallingLetters.length; i++) {
      const l = fallingLetters[i];
      if (!l.marked && isMatchingAnswer(input, l.answer)) {
        playSound("sfx-correct");
        l.marked = true;
        explode(l.x, l.y);
        showFloatingText(l.x, l.y);
        score += 1;
        scoreBox.textContent = `ì ìˆ˜: ${score}`;
        fallingLetters.splice(i, 1);
activeLetters = activeLetters.filter(a => a.id !== l.id);

        updateProgressUI();
        matched = true;
        break;
      }
    }

       if (matched) {
      setTimeout(() => {
      if (activeLetters.length === 0 && fallingLetters.length === 0) {
  if (current + 1 >= quizData.length || !quizData[current + 1]) {
    document.getElementById('congratsScreen').style.display = 'flex';
    return;
  }


  const box = document.getElementById('questionBox');
  box.classList.add('fade-out');
  setTimeout(() => {
    playSound("sfx-next");
    current++;
    loadQuestion();
    box.classList.remove('fade-out');
    box.classList.add('fade-in');
    setTimeout(() => box.classList.remove('fade-in'), 500);
  }, 500);
}
      }, 100);
    }
                  

if (!matched) {
  playSound("sfx-wrong");
  failCount++;
  updateFailCountUI(); // âœ… ì—¬ê¸° ì¶”ê°€

  // ğŸ¯ í•´ì„¤ì€ ì •í™•íˆ 5ë²ˆì§¸ í‹€ë ¸ì„ ë•Œë§Œ
  if (failCount === 5) {
    document.getElementById("hintText").textContent = quizData[current].explain;
    explainBox.classList.add('visible');
    explainBox.style.display = 'block';
  }

  // ğŸ¯ ì „ì²´ ë³´ê¸° íŒì—…ì€ ì •í™•íˆ 10ë²ˆì§¸ í‹€ë ¸ì„ ë•Œë§Œ
  if (failCount === 10) {
    const fullHintBox = document.getElementById('fullHintPopup');
    const content = document.getElementById('fullHintContent');
    const currentQuiz = quizData[current];
    let html = `<strong>ë¬¸ì œ:</strong> ${currentQuiz.title}<br><br>`;
    html += `<strong>íŒíŠ¸:</strong> ${currentQuiz.hint}<br><br>`;
    html += `<strong>ì •ë‹µ ëª©ë¡:</strong><br><ul>`;
    currentQuiz.answers.forEach(ans => {
      html += `<li><strong>${ans.letter}</strong>: ${ans.text}</li>`;
    });
    html += `</ul><br><em style="color:#ccc;">â€» í•™ìŠµìš©ìœ¼ë¡œ ì •ë‹µ ì „ì²´ë¥¼ ë³´ì—¬ë“œë¦½ë‹ˆë‹¤.</em>`;
    content.innerHTML = html;
    fullHintBox.style.display = 'block';
  }

  setTimeout(() => textInput.classList.remove('shake'), 300);





          if (failCount >= 5) {
            document.getElementById("hintText").textContent = quizData[current].explain;
explainBox.classList.add('visible');
           explainBox.style.display = 'block';
          }
          textInput.classList.add('shake');
          setTimeout(() => textInput.classList.remove('shake'), 300);
        }
        textInput.value = '';
      }   
    });


function isMatchingAnswer(userInput, answerObj) {
  const normalize = str =>
    str.replace(/\s/g, '')
       .replace(/[^\wê°€-í£]/g, '')
       .toLowerCase();

  const input = normalize(userInput);
  const base = normalize(answerObj.text);
  const aliases = (answerObj.aliases || []).map(normalize);

  if (matchMode === 'strict') {
    return input === base || aliases.includes(input);
  }

  if (matchMode === 'normal') {
    const wordsMatch = (inputRaw, targetRaw) => {
      const tokenize = str => str.match(/[ê°€-í£\w]+/g) || [];
      const inputWords = tokenize(inputRaw);
      const targetWords = tokenize(targetRaw);
      return targetWords.every(tw => inputWords.some(iw => iw.includes(tw)));
    };
    return input.includes(base)
        || aliases.some(a => input.includes(a))
        || wordsMatch(userInput, answerObj.text)
        || aliases.some(alias => wordsMatch(userInput, alias));
  }

  if (matchMode === 'fuzzy') {
    return getSimilarity(input, base) >= 0.8
        || aliases.some(alias => getSimilarity(input, alias) >= 0.8);
  }

  return false;
}


function getSimilarity(a, b) {
  const distance = levenshtein(a, b);
  return 1 - distance / Math.max(a.length, b.length);
}

function levenshtein(a, b) {
  const matrix = Array.from({ length: a.length + 1 }, () => []);
  for (let i = 0; i <= a.length; i++) matrix[i][0] = i;
  for (let j = 0; j <= b.length; j++) matrix[0][j] = j;

  for (let i = 1; i <= a.length; i++) {
    for (let j = 1; j <= b.length; j++) {
      const cost = a[i - 1] === b[j - 1] ? 0 : 1;
      matrix[i][j] = Math.min(
        matrix[i - 1][j] + 1,
        matrix[i][j - 1] + 1,
        matrix[i - 1][j - 1] + cost
      );
    }
  }
  return matrix[a.length][b.length];
}




shuffleArray(quizData);
animate();
textInput.focus();
document.getElementById('statusBox').textContent = 'ì§„í–‰: - / -';

// âœ… ì—¬ê¸° ì•„ë˜ì— ë°”ë¡œ ì¶”ê°€í•˜ì„¸ìš”
document.querySelectorAll('input[name="mode"]').forEach(radio => {
  radio.addEventListener('change', (e) => {
    matchMode = e.target.value;
    console.log(`âœ… ì •ë‹µ ì²´í¬ ëª¨ë“œ ë³€ê²½ë¨: ${matchMode}`);
  });
});



// âœ… ì¸íŠ¸ë¡œ í™”ë©´ í´ë¦­ ì‹œ textInputì— í¬ì»¤ìŠ¤
document.getElementById('startScreen').addEventListener('click', () => {
  textInput.focus();
});
// âœ… ì™„ë£Œ í™”ë©´ ìˆ¨ê¹€ ì´ˆê¸°í™” (ì¸íŠ¸ë¡œì—ì„œ ì ê¹ ë³´ì´ëŠ” ê²ƒ ë°©ì§€)
document.getElementById('congratsScreen').style.display = 'none';


document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') {
    const fullHintBox = document.getElementById('fullHintPopup');

    if (fullHintBox.style.display === 'block') {
      closeFullHintPopup(); // âœ… ì´ê±¸ë¡œ êµì²´
    } else {
      openFullHintManually();
    }
  }






  
  // âœ… Shift + â†’ë¡œ ë¬¸ì œ ìŠ¤í‚µ
  if (e.shiftKey && e.key === 'ArrowRight') {
    if (!isStarted || isPaused) return;

    if (current + 1 >= quizData.length) {
      document.getElementById('congratsScreen').style.display = 'flex';
      return;
    }


    

    current++;
      failCount = 0; // âœ… ì´ ì¤„ì„ ì¶”ê°€í•˜ì„¸ìš”!!!
updateFailCountUI(); // âœ… ì´ˆê¸°í™” ì‹œ UI ë°˜ì˜




    loadQuestion();
    updateStatusBox();
    playSound("sfx-next");

    // íš¨ê³¼ì ìœ¼ë¡œ ë‹¤ìŒ ë¬¸ì œ ë„˜ì–´ê°ˆ ìˆ˜ ìˆê²Œ ì…ë ¥ì°½ ì´ˆê¸°í™”
    textInput.value = '';
    explainBox.style.display = 'none';
    explainBox.classList.remove('visible');
    return;
  }

  // ê¸°ì¡´ Enter ê´€ë ¨ í¬ì»¤ìŠ¤ ë³µêµ¬
  if (e.key === 'Enter') {
    const isInputFocused = (document.activeElement.id === 'textInput');
    const isStartScreen = document.getElementById('startScreen').style.display !== 'none';
    const isCongratsScreen = document.getElementById('congratsScreen').style.display === 'flex';

    if (isStartScreen || isCongratsScreen) return;

    if (!isInputFocused) {
      e.preventDefault();
      textInput.focus();
      textInput.select();  // í…ìŠ¤íŠ¸ ì „ì²´ ì„ íƒ (UX í–¥ìƒ)
    }
  }
});


document.addEventListener("visibilitychange", function () {
  if (document.hidden) {
    cancelAnimationFrame(animationFrameId); // âœ… ë£¨í”„ ì¤‘ì§€
  } else {
    // ìˆ˜ë™ ì¼ì‹œì •ì§€ ì¤‘ì´ ì•„ë‹ˆê³ , ê²Œì„ì´ ì‹œì‘ëœ ìƒíƒœë©´ ì¬ê°œ
    if (!wasManuallyPaused && isStarted) {
      animate(); // âœ… ì¤‘ë³µ ë°©ì§€ëœ ì•ˆì „í•œ ì¬ì‹œì‘
    }
  }
});




function startQuiz() {
  if (isStarted) return;
  isStarted = true;
  document.getElementById('startScreen').style.display = 'none';
  questionBox.style.display = 'block';
  loadQuestion();
  updateStatusBox();
  setTimeout(() => {
    textInput.focus();
    textInput.select();
  }, 0);
}



// ëª¨ë°”ì¼ í„°ì¹˜ ë˜ëŠ” í´ë¦­ìœ¼ë¡œ ì‹œì‘
const startScreen = document.getElementById('startScreen');
startScreen.addEventListener('click', startQuiz);
startScreen.addEventListener('touchstart', startQuiz);




  </script>



<div id="fullHintPopup" style="
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.95);
  color: #00ffe1;
  font-family: 'Pretendard', sans-serif;
  z-index: 9999;
  padding: 40px 20px;
  overflow-y: auto;
  box-sizing: border-box;
">

  <div style="max-width: 600px; margin: 0 auto; background: #111; border: 1px solid #00ffe1; padding: 20px; border-radius: 12px;">
    <h2 style="text-align: center; margin-top: 0; font-family: 'Orbitron'; font-size: 1.5rem;">ğŸ’¡ íŒíŠ¸ ì „ì²´ ë³´ê¸°</h2>
    <div id="fullHintContent" style="font-size: 1rem; line-height: 1.6;"></div>


<button onclick="closeFullHintPopup()" style="
background: rgba(255, 255, 255, 0.06);
  border: 1px solid var(--main-accent);
  border-radius: 12px;
  color: var(--main-accent);
  font-family: 'Orbitron', sans-serif;
  font-size: 0.95rem;
  padding: 6px 12px;
  transition: all 0.3s ease;
  backdrop-filter: blur(4px);
  cursor: pointer;
">
  ë‹«ê¸° âœ–
</button>

</div>






  </div>
</div>

</body>
</html>
